# ğŸ”„ Complete Request Flow: React â†’ Backend â†’ Response

## Visual Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          REACT FRONTEND                                  â”‚
â”‚  (User fills form: Name, Policy No, Death Certificate, Claim Amount)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ HTTP POST Request
                                 â”‚ /api/claim/submit
                                 â”‚ (FormData with files)
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SPRING BOOT BACKEND                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  1ï¸âƒ£  ClaimController.submitClaim()                                â”‚  â”‚
â”‚  â”‚      - Receives HTTP request                                      â”‚  â”‚
â”‚  â”‚      - Extracts: name, policyNumber, claimAmount, files          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                            â”‚
â”‚                             â”‚ Calls                                      â”‚
â”‚                             â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  2ï¸âƒ£  BlobStorageService.uploadFiles()                            â”‚  â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚      â”‚  For each file:                                       â”‚    â”‚  â”‚
â”‚  â”‚      â”‚  - Generate unique filename (UUID + original name)    â”‚    â”‚  â”‚
â”‚  â”‚      â”‚  - Upload to Azure Blob Storage                       â”‚    â”‚  â”‚
â”‚  â”‚      â”‚  - Get blob URL                                       â”‚    â”‚  â”‚
â”‚  â”‚      â”‚  - Return List<String> URLs                          â”‚    â”‚  â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                            â”‚
â”‚                             â”‚ Returns file URLs                          â”‚
â”‚                             â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  3ï¸âƒ£  PolicyRuleService.checkPolicyExists()                       â”‚  â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚      â”‚  ğŸ” Check if policy exists in database (FAST)        â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     - Query: policyRepository.findByPolicyNumber()   â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     - If NOT found â†’ REJECT immediately âŒ           â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     - If found â†’ Continue to OCR (saves cost!)       â”‚    â”‚  â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                            â”‚
â”‚                             â”‚ Policy exists, proceed to OCR              â”‚
â”‚                             â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  4ï¸âƒ£  DocumentAIService.extractText()                             â”‚  â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚      â”‚  For each document URL from Blob Storage:            â”‚    â”‚  â”‚
â”‚  â”‚      â”‚  - Pass Azure Blob URL (NOT image bytes!)            â”‚    â”‚  â”‚
â”‚  â”‚      â”‚  - Send to Azure Document Intelligence               â”‚    â”‚  â”‚
â”‚  â”‚      â”‚  - Document AI downloads from URL directly           â”‚    â”‚  â”‚
â”‚  â”‚      â”‚  - Extract text using OCR (EXPENSIVE)                â”‚    â”‚  â”‚
â”‚  â”‚      â”‚  - Return extracted text strings                     â”‚    â”‚  â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                            â”‚
â”‚                             â”‚ Returns extracted text                     â”‚
â”‚                             â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  5ï¸âƒ£  PolicyRuleService.validateClaim()                           â”‚  â”‚
â”‚  â”‚      â†’ Calls AzureOpenAIService (with RAG + LangChain4j)         â”‚  â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚      â”‚  ğŸ“š Step 1: RAG - Load Policy Rules                  â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     - Load text files from policy-rules/ folder:     â”‚    â”‚  â”‚
â”‚  â”‚      â”‚       â€¢ eligibility.txt                              â”‚    â”‚  â”‚
â”‚  â”‚      â”‚       â€¢ death-verification.txt                       â”‚    â”‚  â”‚
â”‚  â”‚      â”‚       â€¢ claim-amount.txt                             â”‚    â”‚  â”‚
â”‚  â”‚      â”‚       â€¢ fraud-indicators.txt                         â”‚    â”‚  â”‚
â”‚  â”‚      â”‚       â€¢ documentation.txt                            â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     - Convert to embeddings using text-embedding    â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     - Store in in-memory vector store               â”‚    â”‚  â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚      â”‚  ğŸ¤– Step 2: Create AI Agent with Tools               â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     Tools available to agent:                        â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     â€¢ checkPolicyEligibility()                       â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     â€¢ validateClaimAmount()                          â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     â€¢ checkFraudIndicators()                         â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     â€¢ verifyDocumentation()                          â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     â€¢ checkTimeLimits()                              â”‚    â”‚  â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚      â”‚  ğŸ§  Step 3: AI Decision Making                       â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     - Send prompt with:                              â”‚    â”‚  â”‚
â”‚  â”‚      â”‚       â€¢ Policy details from database                â”‚    â”‚  â”‚
â”‚  â”‚      â”‚       â€¢ Extracted document text (OCR)                â”‚    â”‚  â”‚
â”‚  â”‚      â”‚       â€¢ Claim amount requested                       â”‚    â”‚  â”‚
â”‚  â”‚      â”‚       â€¢ RAG knowledge base (policy rules)            â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     - Agent uses tools to validate                  â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     - GPT-4o analyzes everything                     â”‚    â”‚  â”‚
â”‚  â”‚      â”‚     - Returns: APPROVED/REJECTED + reasoning        â”‚    â”‚  â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                            â”‚
â”‚                             â”‚ Returns AI decision                        â”‚
â”‚                             â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  6ï¸âƒ£  Save to Database                                             â”‚  â”‚
â”‚  â”‚      - Create Claim entity with:                                  â”‚  â”‚
â”‚  â”‚        â€¢ claimantName                                             â”‚  â”‚
â”‚  â”‚        â€¢ policyNumber                                             â”‚  â”‚
â”‚  â”‚        â€¢ claimAmount                                              â”‚  â”‚
â”‚  â”‚        â€¢ status (APPROVED/REJECTED)                               â”‚  â”‚
â”‚  â”‚        â€¢ aiResponse (reasoning)                                   â”‚  â”‚
â”‚  â”‚        â€¢ documentUrls (blob storage URLs)                         â”‚  â”‚
â”‚  â”‚        â€¢ submissionDate                                           â”‚  â”‚
â”‚  â”‚      - claimRepository.save(claim)                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                            â”‚
â”‚                             â”‚ Returns saved Claim                        â”‚
â”‚                             â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  7ï¸âƒ£  ClaimController builds response                             â”‚  â”‚
â”‚  â”‚      - Create ClaimResponse DTO with:                             â”‚  â”‚
â”‚  â”‚        â€¢ message: "Claim processed successfully"                  â”‚  â”‚
â”‚  â”‚        â€¢ claimStatus: "APPROVED"                                  â”‚  â”‚
â”‚  â”‚        â€¢ aiResponse: "Approved because..."                        â”‚  â”‚
â”‚  â”‚        â€¢ claimId: 123                                             â”‚  â”‚
â”‚  â”‚      - Return ResponseEntity.ok(response)                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ JSON Response
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          REACT FRONTEND                                  â”‚
â”‚  - Receives JSON response                                               â”‚
â”‚  - Shows success message: "Claim Approved! âœ…"                          â”‚
â”‚  - Displays AI reasoning                                                â”‚
â”‚  - Shows claim ID for tracking                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ External Azure Services Used

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AZURE CLOUD SERVICES                           â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Azure Blob Storage    â”‚â”€â”€â”€â–¶â”‚  Azure Document AI      â”‚      â”‚
â”‚  â”‚  - Stores uploaded     â”‚    â”‚  - Downloads from URL   â”‚      â”‚
â”‚  â”‚    death certificates  â”‚    â”‚  - OCR text extraction  â”‚      â”‚
â”‚  â”‚  - Returns URLs        â”‚    â”‚  - Reads PDFs, images   â”‚      â”‚
â”‚  â”‚                        â”‚    â”‚  - Returns text         â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Azure OpenAI GPT-4o   â”‚    â”‚  Azure SQL Database     â”‚      â”‚
â”‚  â”‚  - AI decision making  â”‚    â”‚  - Stores policies      â”‚      â”‚
â”‚  â”‚  - Uses RAG knowledge  â”‚    â”‚  - Stores claims        â”‚      â”‚
â”‚  â”‚  - Agent with tools    â”‚    â”‚  - Permanent storage    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚  â”‚  Text Embedding Model  â”‚                                      â”‚
â”‚  â”‚  - Converts rules to   â”‚                                      â”‚
â”‚  â”‚    vector embeddings   â”‚                                      â”‚
â”‚  â”‚  - For RAG search      â”‚                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ Class-Wise Breakdown

### Complete Class Interaction Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONTROLLER LAYER                              â”‚
â”‚  ğŸ“ Package: com.tejas.metlife.claimprocessor.controller        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ClaimController.java                                   â”‚    â”‚
â”‚  â”‚  ------------------------------------------------       â”‚    â”‚
â”‚  â”‚  @RestController                                        â”‚    â”‚
â”‚  â”‚  @RequestMapping("/api/claim")                          â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Methods:                                               â”‚    â”‚
â”‚  â”‚  â€¢ submitClaim(@RequestParam String claimantName,      â”‚    â”‚
â”‚  â”‚                @RequestParam String policyNumber,       â”‚    â”‚
â”‚  â”‚                @RequestParam Double claimAmount,        â”‚    â”‚
â”‚  â”‚                @RequestParam List<MultipartFile> files) â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Returns: ResponseEntity<ClaimResponse>                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Injects & Calls
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVICE LAYER                                 â”‚
â”‚  ğŸ“ Package: com.tejas.metlife.claimprocessor.service           â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  BlobStorageService.java                                â”‚    â”‚
â”‚  â”‚  ------------------------------------------------       â”‚    â”‚
â”‚  â”‚  @Service                                               â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Fields:                                                â”‚    â”‚
â”‚  â”‚  â€¢ BlobServiceClient blobServiceClient                 â”‚    â”‚
â”‚  â”‚  â€¢ BlobContainerClient containerClient                 â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Methods:                                               â”‚    â”‚
â”‚  â”‚  â€¢ uploadFiles(List<MultipartFile> files)              â”‚    â”‚
â”‚  â”‚    â†’ Returns: List<String> (blob URLs)                 â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â€¢ generateUniqueFileName(String originalName)         â”‚    â”‚
â”‚  â”‚    â†’ Returns: String (UUID-based filename)             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  DocumentAIService.java                                 â”‚    â”‚
â”‚  â”‚  ------------------------------------------------       â”‚    â”‚
â”‚  â”‚  @Service                                               â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Fields:                                                â”‚    â”‚
â”‚  â”‚  â€¢ DocumentAnalysisClient client                       â”‚    â”‚
â”‚  â”‚  â€¢ String endpoint (from properties)                   â”‚    â”‚
â”‚  â”‚  â€¢ String apiKey (from properties)                     â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Methods:                                               â”‚    â”‚
â”‚  â”‚  â€¢ extractTextFromDocument(String documentUrl)         â”‚    â”‚
â”‚  â”‚    â†’ Returns: String (extracted text)                  â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â€¢ analyzeDocument(String url)                         â”‚    â”‚
â”‚  â”‚    â†’ Returns: AnalyzeResult                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  PolicyRuleService.java                                 â”‚    â”‚
â”‚  â”‚  ------------------------------------------------       â”‚    â”‚
â”‚  â”‚  @Service                                               â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Fields:                                                â”‚    â”‚
â”‚  â”‚  â€¢ PolicyRepository policyRepository                   â”‚    â”‚
â”‚  â”‚  â€¢ ClaimRepository claimRepository                     â”‚    â”‚
â”‚  â”‚  â€¢ AzureOpenAIService azureOpenAIService               â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Methods:                                               â”‚    â”‚
â”‚  â”‚  â€¢ validateClaim(String policyNumber,                  â”‚    â”‚
â”‚  â”‚                  Double claimAmount,                    â”‚    â”‚
â”‚  â”‚                  String extractedText)                  â”‚    â”‚
â”‚  â”‚    â†’ Returns: String (AI decision)                     â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â€¢ checkPolicyEligibility(Policy policy)               â”‚    â”‚
â”‚  â”‚    â†’ Returns: boolean                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  AzureOpenAIService.java                                â”‚    â”‚
â”‚  â”‚  ------------------------------------------------       â”‚    â”‚
â”‚  â”‚  @Service                                               â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Fields:                                                â”‚    â”‚
â”‚  â”‚  â€¢ ChatLanguageModel chatModel                         â”‚    â”‚
â”‚  â”‚  â€¢ EmbeddingModel embeddingModel                       â”‚    â”‚
â”‚  â”‚  â€¢ EmbeddingStore<TextSegment> embeddingStore          â”‚    â”‚
â”‚  â”‚  â€¢ ContentRetriever contentRetriever                   â”‚    â”‚
â”‚  â”‚  â€¢ PolicyRepository policyRepository                   â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Methods:                                               â”‚    â”‚
â”‚  â”‚  â€¢ @PostConstruct loadPolicyRules()                    â”‚    â”‚
â”‚  â”‚    â†’ Loads RAG knowledge base at startup               â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â€¢ makeClaimDecision(Policy policy,                    â”‚    â”‚
â”‚  â”‚                      String extractedText,              â”‚    â”‚
â”‚  â”‚                      Double claimAmount)                â”‚    â”‚
â”‚  â”‚    â†’ Creates AI Agent with tools                       â”‚    â”‚
â”‚  â”‚    â†’ Returns: String (AI decision)                     â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Inner Class: ClaimAdjusterAgent                       â”‚    â”‚
â”‚  â”‚  â€¢ @Tool checkPolicyEligibility(...)                   â”‚    â”‚
â”‚  â”‚  â€¢ @Tool validateClaimAmount(...)                      â”‚    â”‚
â”‚  â”‚  â€¢ @Tool checkFraudIndicators(...)                     â”‚    â”‚
â”‚  â”‚  â€¢ @Tool verifyDocumentation(...)                      â”‚    â”‚
â”‚  â”‚  â€¢ @Tool checkTimeLimits(...)                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Uses
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REPOSITORY LAYER                              â”‚
â”‚  ğŸ“ Package: com.tejas.metlife.claimprocessor.repository        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  PolicyRepository.java                                  â”‚    â”‚
â”‚  â”‚  ------------------------------------------------       â”‚    â”‚
â”‚  â”‚  @Repository                                            â”‚    â”‚
â”‚  â”‚  extends JpaRepository<Policy, Long>                    â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Methods:                                               â”‚    â”‚
â”‚  â”‚  â€¢ findByPolicyNumber(String policyNumber)             â”‚    â”‚
â”‚  â”‚    â†’ Returns: Optional<Policy>                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ClaimRepository.java                                   â”‚    â”‚
â”‚  â”‚  ------------------------------------------------       â”‚    â”‚
â”‚  â”‚  @Repository                                            â”‚    â”‚
â”‚  â”‚  extends JpaRepository<Claim, Long>                     â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Methods:                                               â”‚    â”‚
â”‚  â”‚  â€¢ save(Claim claim)                                    â”‚    â”‚
â”‚  â”‚    â†’ Returns: Claim (saved entity)                     â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â€¢ findAll()                                            â”‚    â”‚
â”‚  â”‚    â†’ Returns: List<Claim>                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Maps to
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MODEL LAYER (Entities)                        â”‚
â”‚  ğŸ“ Package: com.tejas.metlife.claimprocessor.model             â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Policy.java                                            â”‚    â”‚
â”‚  â”‚  ------------------------------------------------       â”‚    â”‚
â”‚  â”‚  @Entity                                                â”‚    â”‚
â”‚  â”‚  @Table(name = "policies")                              â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Fields:                                                â”‚    â”‚
â”‚  â”‚  â€¢ Long id (Primary Key)                               â”‚    â”‚
â”‚  â”‚  â€¢ String policyNumber (Unique)                        â”‚    â”‚
â”‚  â”‚  â€¢ String holderName                                    â”‚    â”‚
â”‚  â”‚  â€¢ Double sumAssured                                    â”‚    â”‚
â”‚  â”‚  â€¢ String policyStatus                                  â”‚    â”‚
â”‚  â”‚  â€¢ Boolean premiumPaid                                  â”‚    â”‚
â”‚  â”‚  â€¢ String nomineeName                                   â”‚    â”‚
â”‚  â”‚  â€¢ LocalDate startDate                                  â”‚    â”‚
â”‚  â”‚  â€¢ LocalDate endDate                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Claim.java                                             â”‚    â”‚
â”‚  â”‚  ------------------------------------------------       â”‚    â”‚
â”‚  â”‚  @Entity                                                â”‚    â”‚
â”‚  â”‚  @Table(name = "claims")                                â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Fields:                                                â”‚    â”‚
â”‚  â”‚  â€¢ Long id (Primary Key, Auto-generated)               â”‚    â”‚
â”‚  â”‚  â€¢ String claimantName                                  â”‚    â”‚
â”‚  â”‚  â€¢ String policyNumber                                  â”‚    â”‚
â”‚  â”‚  â€¢ Double claimAmount                                   â”‚    â”‚
â”‚  â”‚  â€¢ String status (APPROVED/REJECTED)                   â”‚    â”‚
â”‚  â”‚  â€¢ String aiResponse (AI reasoning)                    â”‚    â”‚
â”‚  â”‚  â€¢ String documentUrls (Blob URLs)                     â”‚    â”‚
â”‚  â”‚  â€¢ LocalDateTime submissionDate                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Transferred as
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DTO LAYER (Data Transfer Objects)             â”‚
â”‚  ğŸ“ Package: com.tejas.metlife.claimprocessor.dto               â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ClaimRequest.java                                      â”‚    â”‚
â”‚  â”‚  ------------------------------------------------       â”‚    â”‚
â”‚  â”‚  Fields:                                                â”‚    â”‚
â”‚  â”‚  â€¢ String claimantName                                  â”‚    â”‚
â”‚  â”‚  â€¢ String policyNumber                                  â”‚    â”‚
â”‚  â”‚  â€¢ Double claimAmount                                   â”‚    â”‚
â”‚  â”‚  â€¢ List<MultipartFile> documents                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ClaimResponse.java                                     â”‚    â”‚
â”‚  â”‚  ------------------------------------------------       â”‚    â”‚
â”‚  â”‚  Fields:                                                â”‚    â”‚
â”‚  â”‚  â€¢ String message                                       â”‚    â”‚
â”‚  â”‚  â€¢ String claimStatus (APPROVED/REJECTED)              â”‚    â”‚
â”‚  â”‚  â€¢ String aiResponse                                    â”‚    â”‚
â”‚  â”‚  â€¢ Long claimId                                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Detailed Method Call Sequence

### Step-by-Step Class Method Execution

#### **1ï¸âƒ£ ClaimController.submitClaim()**
```java
// File: ClaimController.java
@PostMapping("/submit")
public ResponseEntity<ClaimResponse> submitClaim(
    @RequestParam String claimantName,
    @RequestParam String policyNumber,
    @RequestParam Double claimAmount,
    @RequestParam("documents") List<MultipartFile> files
) {
    // Step 1: Upload files to Azure Blob Storage
    List<String> documentUrls = blobStorageService.uploadFiles(files);
    
    // Step 2: Check if policy exists BEFORE expensive OCR (optimization!)
    Optional<Policy> policyOpt = policyRepository.findByPolicyNumber(policyNumber);
    if (policyOpt.isEmpty()) {
        ClaimResponse errorResponse = new ClaimResponse();
        errorResponse.setMessage("Policy not found");
        errorResponse.setClaimStatus("REJECTED");
        errorResponse.setAiResponse("REJECTED: Policy number not found in our records.");
        return ResponseEntity.badRequest().body(errorResponse);
    }
    
    // Step 3: Extract text from documents (now we know policy exists)
    // We pass Blob Storage URLs (NOT image bytes!) to Document AI
    // Document AI downloads directly from Blob Storage for efficiency
    List<String> extractedTexts = new ArrayList<>();
    for (String url : documentUrls) {  // url = https://tejasclaimstorage.blob...pdf
        String text = documentAIService.extractTextFromDocument(url);
        extractedTexts.add(text);
    }
    
    // Step 4: Validate claim using AI
    String aiDecision = policyRuleService.validateClaim(
        policyOpt.get(),  // Pass the Policy object directly
        claimAmount, 
        String.join("\n", extractedTexts)
    );
    
    // Step 5: Save claim to database
    Claim claim = new Claim();
    claim.setClaimantName(claimantName);
    claim.setPolicyNumber(policyNumber);
    claim.setClaimAmount(claimAmount);
    claim.setStatus(aiDecision.contains("APPROVED") ? "APPROVED" : "REJECTED");
    claim.setAiResponse(aiDecision);
    claim.setDocumentUrls(String.join(",", documentUrls));
    claim.setSubmissionDate(LocalDateTime.now());
    
    Claim savedClaim = claimRepository.save(claim);
    
    // Step 6: Build and return response
    ClaimResponse response = new ClaimResponse();
    response.setMessage("Claim processed successfully");
    response.setClaimStatus(savedClaim.getStatus());
    response.setAiResponse(savedClaim.getAiResponse());
    response.setClaimId(savedClaim.getId());
    
    return ResponseEntity.ok(response);
}
```

---

#### **2ï¸âƒ£ BlobStorageService.uploadFiles()**
```java
// File: BlobStorageService.java
@Service
public class BlobStorageService {
    
    private BlobContainerClient containerClient;
    
    public List<String> uploadFiles(List<MultipartFile> files) {
        List<String> uploadedUrls = new ArrayList<>();
        
        for (MultipartFile file : files) {
            try {
                // Generate unique filename
                String uniqueFileName = generateUniqueFileName(file.getOriginalFilename());
                
                // Get blob client for this file
                BlobClient blobClient = containerClient.getBlobClient(uniqueFileName);
                
                // Upload file
                blobClient.upload(file.getInputStream(), file.getSize(), true);
                
                // Get and store URL
                String blobUrl = blobClient.getBlobUrl();
                uploadedUrls.add(blobUrl);
                
            } catch (IOException e) {
                throw new RuntimeException("Failed to upload file", e);
            }
        }
        
        return uploadedUrls;
    }
    
    private String generateUniqueFileName(String originalName) {
        String uuid = UUID.randomUUID().toString();
        return uuid + "-" + originalName;
    }
}
```

---

#### **3ï¸âƒ£ DocumentAIService.extractTextFromDocument()**
```java
// File: DocumentAIService.java
@Service
public class DocumentAIService {
    
    private DocumentAnalysisClient client;
    
    @Value("${azure.document.endpoint}")
    private String endpoint;
    
    @Value("${azure.document.key}")
    private String apiKey;
    
    public String extractTextFromDocument(String documentUrl) {
        try {
            // We pass Azure Blob Storage URL (NOT file bytes!)
            // Azure Document Intelligence downloads directly from Blob Storage
            // This is more efficient than uploading the file again
            SyncPoller<OperationResult, AnalyzeResult> analyzePoller = 
                client.beginAnalyzeDocumentFromUrl("prebuilt-read", documentUrl);
            
            // Wait for result
            AnalyzeResult result = analyzePoller.getFinalResult();
            
            // Extract all text
            StringBuilder extractedText = new StringBuilder();
            result.getPages().forEach(page -> {
                page.getLines().forEach(line -> {
                    extractedText.append(line.getContent()).append("\n");
                });
            });
            
            return extractedText.toString();
            
        } catch (Exception e) {
            throw new RuntimeException("Document analysis failed", e);
        }
    }
}
```

---

#### **4ï¸âƒ£ PolicyRuleService.validateClaim()**
```java
// File: PolicyRuleService.java
@Service
public class PolicyRuleService {
    
    @Autowired
    private PolicyRepository policyRepository;
    
    @Autowired
    private AzureOpenAIService azureOpenAIService;
    
    public String validateClaim(Policy policy,  // Now receives Policy object directly
                                Double claimAmount, 
                                String extractedText) {
        
        // Policy already validated by controller!
        // No need to check existence again
        
        // Step 1: Basic eligibility check
        if (!checkPolicyEligibility(policy)) {
            return "REJECTED: Policy is not eligible for claims.";
        }
        
        // Step 2: Let AI make the decision using RAG + Tools
        String aiDecision = azureOpenAIService.makeClaimDecision(
            policy, 
            extractedText, 
            claimAmount
        );
        
        return aiDecision;
    }
    
    private boolean checkPolicyEligibility(Policy policy) {
        return policy.getPolicyStatus().equals("ACTIVE") 
            && policy.getPremiumPaid();
    }
}
```

---

#### **5ï¸âƒ£ AzureOpenAIService.makeClaimDecision()**
```java
// File: AzureOpenAIService.java
@Service
public class AzureOpenAIService {
    
    private ChatLanguageModel chatModel;
    private EmbeddingModel embeddingModel;
    private EmbeddingStore<TextSegment> embeddingStore;
    private ContentRetriever contentRetriever;
    
    @PostConstruct
    public void loadPolicyRules() {
        // Load RAG knowledge base from policy-rules/ folder
        List<Document> documents = FileSystemDocumentLoader
            .loadDocuments(Paths.get("policy-rules"), glob("*.txt"));
        
        // Split into segments
        DocumentSplitter splitter = DocumentSplitters
            .recursive(300, 50, new OpenAiTokenizer());
        List<TextSegment> segments = splitter.splitAll(documents);
        
        // Generate embeddings and store
        embeddingStore = new InMemoryEmbeddingStore<>();
        EmbeddingStoreIngestor.ingest(segments, embeddingModel, embeddingStore);
        
        // Create content retriever for RAG
        contentRetriever = EmbeddingStoreContentRetriever.builder()
            .embeddingStore(embeddingStore)
            .embeddingModel(embeddingModel)
            .maxResults(5)
            .build();
    }
    
    public String makeClaimDecision(Policy policy, 
                                   String extractedText, 
                                   Double claimAmount) {
        
        // Create AI Agent with tools
        ClaimAdjusterAgent agent = AiServices.builder(ClaimAdjusterAgent.class)
            .chatLanguageModel(chatModel)
            .contentRetriever(contentRetriever)  // RAG
            .tools(this)  // Tools from this class
            .build();
        
        // Build comprehensive prompt
        String prompt = String.format("""
            You are a professional claims adjuster for MetLife insurance.
            
            POLICY INFORMATION:
            - Policy Number: %s
            - Holder Name: %s
            - Sum Assured: â‚¹%.2f
            - Policy Status: %s
            - Premium Paid: %s
            - Nominee: %s
            
            CLAIM REQUEST:
            - Claimant Name: Requesting claim
            - Claim Amount: â‚¹%.2f
            
            EXTRACTED DOCUMENT TEXT:
            %s
            
            Use your available tools to thoroughly validate this claim.
            Check eligibility, claim amount, fraud indicators, documentation, and time limits.
            
            Provide your decision as: APPROVED or REJECTED
            Followed by detailed reasoning.
            """,
            policy.getPolicyNumber(),
            policy.getHolderName(),
            policy.getSumAssured(),
            policy.getPolicyStatus(),
            policy.getPremiumPaid() ? "Yes" : "No",
            policy.getNomineeName(),
            claimAmount,
            extractedText
        );
        
        // AI makes decision using tools and RAG
        String decision = agent.analyzeClaimAndDecide(prompt);
        
        return decision;
    }
    
    // ========== AI AGENT TOOLS ==========
    
    @Tool("Check if policy is eligible for claim processing")
    public String checkPolicyEligibility(String policyNumber) {
        Optional<Policy> policy = policyRepository.findByPolicyNumber(policyNumber);
        if (policy.isEmpty()) {
            return "Policy not found";
        }
        
        Policy p = policy.get();
        if (p.getPolicyStatus().equals("ACTIVE") && p.getPremiumPaid()) {
            return "Policy is eligible: Active status, premiums up to date";
        }
        return "Policy ineligible: Either inactive or premiums pending";
    }
    
    @Tool("Validate if claim amount is within policy limits")
    public String validateClaimAmount(String policyNumber, Double requestedAmount) {
        Optional<Policy> policy = policyRepository.findByPolicyNumber(policyNumber);
        if (policy.isEmpty()) return "Policy not found";
        
        Double sumAssured = policy.get().getSumAssured();
        if (requestedAmount <= sumAssured) {
            return String.format("Valid: Requested â‚¹%.2f is within sum assured â‚¹%.2f", 
                               requestedAmount, sumAssured);
        }
        return String.format("Invalid: Requested â‚¹%.2f exceeds sum assured â‚¹%.2f", 
                           requestedAmount, sumAssured);
    }
    
    @Tool("Check for fraud indicators in the claim")
    public String checkFraudIndicators(String documentText, String policyNumber) {
        // Check for suspicious patterns
        if (documentText.contains("fake") || documentText.contains("forged")) {
            return "FRAUD ALERT: Suspicious keywords detected";
        }
        
        // Check for duplicate claims
        long duplicateCount = claimRepository.countByPolicyNumber(policyNumber);
        if (duplicateCount > 3) {
            return "FRAUD ALERT: Multiple claims on same policy";
        }
        
        return "No fraud indicators detected";
    }
    
    @Tool("Verify if submitted documentation is valid")
    public String verifyDocumentation(String extractedText) {
        // Check for required keywords
        boolean hasDeathCert = extractedText.toLowerCase().contains("death certificate") 
                            || extractedText.toLowerCase().contains("certificate of death");
        boolean hasGovernmentIssued = extractedText.toLowerCase().contains("government");
        boolean hasDate = extractedText.matches(".*\\d{4}-\\d{2}-\\d{2}.*");
        
        if (hasDeathCert && hasGovernmentIssued && hasDate) {
            return "Documentation verified: Valid death certificate with date";
        }
        return "Documentation incomplete or invalid";
    }
    
    @Tool("Check if claim is within time limits")
    public String checkTimeLimits(String policyNumber) {
        Optional<Policy> policy = policyRepository.findByPolicyNumber(policyNumber);
        if (policy.isEmpty()) return "Policy not found";
        
        LocalDate startDate = policy.get().getStartDate();
        long daysSinceStart = ChronoUnit.DAYS.between(startDate, LocalDate.now());
        
        if (daysSinceStart < 730) {  // 2 years
            return "WARNING: Policy less than 2 years old";
        }
        return "Time limits satisfied: Policy active for " + (daysSinceStart / 365) + " years";
    }
    
    // Inner interface for AI Agent
    interface ClaimAdjusterAgent {
        String analyzeClaimAndDecide(String prompt);
    }
}
```

---

## ğŸ”„ Class Dependency Diagram

```
ClaimController
    â”œâ”€â”€ @Autowired BlobStorageService
    â”œâ”€â”€ @Autowired DocumentAIService
    â”œâ”€â”€ @Autowired PolicyRuleService
    â””â”€â”€ @Autowired ClaimRepository

BlobStorageService
    â””â”€â”€ Uses: Azure BlobServiceClient (External SDK)

DocumentAIService
    â””â”€â”€ Uses: Azure DocumentAnalysisClient (External SDK)

PolicyRuleService
    â”œâ”€â”€ @Autowired PolicyRepository
    â””â”€â”€ @Autowired AzureOpenAIService

AzureOpenAIService
    â”œâ”€â”€ @Autowired PolicyRepository
    â”œâ”€â”€ Uses: LangChain4j ChatLanguageModel
    â”œâ”€â”€ Uses: LangChain4j EmbeddingModel
    â””â”€â”€ Uses: LangChain4j EmbeddingStore

PolicyRepository
    â”œâ”€â”€ extends JpaRepository<Policy, Long>
    â””â”€â”€ Connected to: Azure SQL Database

ClaimRepository
    â”œâ”€â”€ extends JpaRepository<Claim, Long>
    â””â”€â”€ Connected to: Azure SQL Database
```

---

## ğŸ›ï¸ Architecture Pattern: Layered Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PRESENTATION LAYER (React Frontend)             â”‚
â”‚  - User Interface                                â”‚
â”‚  - Form Handling                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTP/JSON
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONTROLLER LAYER                                â”‚
â”‚  - ClaimController                               â”‚
â”‚  - Request/Response handling                     â”‚
â”‚  - Input validation                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ Method Calls
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SERVICE LAYER (Business Logic)                  â”‚
â”‚  - BlobStorageService                            â”‚
â”‚  - DocumentAIService                             â”‚
â”‚  - PolicyRuleService                             â”‚
â”‚  - AzureOpenAIService                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ JPA Queries
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  REPOSITORY LAYER (Data Access)                  â”‚
â”‚  - PolicyRepository                              â”‚
â”‚  - ClaimRepository                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ SQL Queries
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DATABASE LAYER                                  â”‚
â”‚  - Azure SQL Database                            â”‚
â”‚  - Tables: policies, claims                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Simple Step-by-Step Explanation

### **Step 1: React Sends Data** ğŸ–¥ï¸
User fills a form on the website with:
- Name: "Tejas Avhad"
- Policy Number: "POL123456"
- Claim Amount: â‚¹5,00,000
- Death Certificate (PDF file)

React sends this data to Spring Boot backend using `fetch()` API.

---

### **Step 2: Controller Receives Request** ğŸ¯
`ClaimController` receives the HTTP POST request at `/api/claim/submit` endpoint. It extracts all the data and starts processing.

---

### **Step 3: Check if Policy Exists** ğŸ” âš¡
`PolicyRepository` checks the database FIRST (before expensive OCR):
- Query: `findByPolicyNumber("POL123456")`
- Database lookup takes only ~50-100ms
- If policy NOT found â†’ **REJECT immediately** âŒ
- **Why this order?** Saves money! No point doing expensive OCR ($$$) if policy doesn't exist

**Example:**
```java
Optional<Policy> policy = policyRepository.findByPolicyNumber("POL123456");
if (policy.isEmpty()) {
    return "REJECTED: Policy not found";
    // Saved 3-5 seconds of OCR time!
    // Saved Azure Document AI API costs!
}
```

---

### **Step 4: Upload Files to Cloud** â˜ï¸
`BlobStorageService` takes the death certificate PDF and:
1. Generates a unique filename (so files don't overwrite)
2. Uploads it to **Azure Blob Storage** (like Google Drive but for apps)
3. Returns the URL where the file is stored

**Example URL**: `https://blobname.blob.core.windows.net/claims-documents/abc123-death-certificate.pdf`

---

### **Step 5: Extract Text from PDF** ğŸ“„
`DocumentAIService` takes the **Azure Blob Storage URL** (not direct image!) and:
1. Sends the **URL** to **Azure Document Intelligence** (AI OCR service)
2. Document Intelligence **downloads the PDF from Blob Storage directly**
3. AI reads the PDF and extracts all text
4. Returns extracted text like: "Certificate of Death. Name: John Doe. Date: 2024-01-15..."

**Why URL instead of direct image?**
- âœ… **More efficient**: No need to load file into memory twice
- âœ… **Azure-optimized**: Azure services communicate directly with each other (faster)
- âœ… **No size limits**: Large files don't need to pass through our server
- âœ… **Less bandwidth**: We don't re-upload the same file

**How it works:**
```java
// We pass the Blob Storage URL, not file bytes!
String blobUrl = "https://tejasclaimstorage.blob.core.windows.net/claims/abc-123.pdf";
String extractedText = documentAIService.extractTextFromDocument(blobUrl);

// Inside the service:
client.beginAnalyzeDocumentFromUrl("prebuilt-read", blobUrl);
// Document AI fetches the file directly from Blob Storage!
```

This is needed because AI can't read images/PDFs directly - it needs text!

---

### **Step 6: AI Makes the Decision** ğŸ¤– (Most Important!)

This is where the magic happens! `AzureOpenAIService` does:

#### **6a. Load Knowledge Base (RAG)** ğŸ“š
- Loads policy rule files from `policy-rules/` folder:
  - `eligibility.txt`: "Policy must be active for 2+ years"
  - `death-verification.txt`: "Death certificate must be government issued"
  - `claim-amount.txt`: "Cannot exceed sum assured"
  - `fraud-indicators.txt`: "Check for suspicious patterns"
  
- Converts these text files to **embeddings** (vector numbers)
- Stores in memory so AI can search through them

#### **6b. Create AI Agent with Tools** ğŸ› ï¸
LangChain4j creates an AI agent with special tools:
- `checkPolicyEligibility()`: Checks if policy is active, premium paid
- `validateClaimAmount()`: Checks if amount â‰¤ sum assured
- `checkFraudIndicators()`: Looks for red flags
- `verifyDocumentation()`: Checks if death certificate is valid

The AI can **call these tools by itself** to gather information!

#### **6c. AI Analyzes Everything** ğŸ§ 
We send GPT-4o a prompt like:

```
You are a claims adjuster. Analyze this claim:

Policy Details:
- Policy Number: POL123456
- Holder Name: John Doe
- Sum Assured: â‚¹10,00,000
- Policy Status: Active
- Premium Paid: Yes

Claim Request:
- Claimant: Jane Doe (Wife)
- Claim Amount: â‚¹5,00,000
- Relationship: Nominee

Extracted Death Certificate Text:
"Certificate of Death. Government of India. Name: John Doe. 
 Date of Death: 2024-01-15. Cause: Natural causes..."

Use your tools to validate this claim against our policy rules.
Decide: APPROVED or REJECTED with clear reasoning.
```

The AI:
1. Calls `checkPolicyEligibility()` â†’ "Policy active âœ…"
2. Calls `validateClaimAmount()` â†’ "â‚¹5L < â‚¹10L sum assured âœ…"
3. Calls `checkFraudIndicators()` â†’ "No red flags âœ…"
4. Calls `verifyDocumentation()` â†’ "Death cert valid âœ…"
5. Makes decision: **APPROVED** âœ…

Returns response:
```
APPROVED: All validations passed. Policy is active, claimant is 
registered nominee, death certificate is valid, claim amount 
â‚¹5,00,000 is within sum assured limit of â‚¹10,00,000.
```

---

### **Step 7: Save to Database** ğŸ’¾
Create a `Claim` entity and save to **Azure SQL Database**:
```java
Claim claim = new Claim();
claim.setClaimantName("Jane Doe");
claim.setPolicyNumber("POL123456");
claim.setClaimAmount(500000);
claim.setStatus("APPROVED");
claim.setAiResponse("Approved: All validations passed...");
claim.setDocumentUrls(["https://...pdf"]);
claimRepository.save(claim);
```

Now this claim is permanently stored!

---

### **Step 8: Send Response to React** ğŸ“¤
Controller creates a `ClaimResponse` JSON:
```json
{
  "message": "Claim processed successfully",
  "claimStatus": "APPROVED",
  "aiResponse": "Approved: All validations passed. Policy is active...",
  "claimId": 123
}
```

Sends it back to React frontend.

---

### **Step 9: React Shows Result** ğŸ‰
React receives the JSON and displays:
```
âœ… Claim Approved!

Claim ID: 123
Status: APPROVED

AI Decision:
"Approved: All validations passed. Policy is active, claimant is 
registered nominee, death certificate is valid, claim amount 
â‚¹5,00,000 is within sum assured limit of â‚¹10,00,000."
```

User sees this on their screen! ğŸŠ

---

## ğŸ”‘ Key Technologies Used at Each Step

| Step | Technology | Purpose |
|------|-----------|---------|
| 1 | React + Fetch API | Send HTTP request to backend |
| 2 | Spring Boot `@RestController` | Receive HTTP request |
| 3 | Azure Blob Storage SDK | Upload files to cloud |
| 4 | Azure Document Intelligence | Extract text from PDFs using OCR |
| 5 | Spring Data JPA | Query database for policy |
| 6a | LangChain4j EmbeddingStore | RAG - Store policy rules as vectors |
| 6b | LangChain4j AI Agent | Create agent with tools |
| 6c | Azure OpenAI GPT-4o | AI decision making |
| 7 | Hibernate + JPA | Save claim to database |
| 8 | Jackson JSON | Convert Java object to JSON |
| 9 | React State | Display result to user |

---

## â±ï¸ Time Breakdown (Approximate)

```
React Request â†’ Controller:          50ms
Upload to Blob Storage:               2-3 seconds
Database Policy Check:                100ms âš¡ (BEFORE OCR!)
Document AI OCR:                      3-5 seconds
RAG Loading (first time):             500ms
RAG Loading (cached):                 50ms
AI Decision (GPT-4o):                 2-4 seconds
Save to Database:                     200ms
Response to React:                    50ms

Total: 8-13 seconds per claim
```

---

## ğŸ¯ Summary

**In Simple Words:**

1. **React** â†’ Sends form data with death certificate
2. **Controller** â†’ Receives and coordinates everything
3. **Blob Storage** â†’ Stores the PDF file (fast, ~2 seconds)
4. **Database** â†’ Checks if policy exists (FAST! ~100ms) âš¡
5. **Document AI** â†’ Reads text from PDF (expensive, only if policy exists)
6. **AI + RAG** â†’ Analyzes everything using policy rules and makes decision
7. **Database** â†’ Saves the claim permanently
8. **React** â†’ Shows result to user

The whole process is **automated** - no human needed to review! The AI acts like a claims adjuster, reading documents, checking policies, and making decisions based on company rules. ğŸš€

---

**ğŸ“Œ Note**: The AI's decision is based on:
- **Policy rules** (loaded via RAG)
- **Database records** (policy details)
- **Document verification** (OCR extracted text)
- **Business logic** (tool functions)

Everything happens in **one API call** - user submits, AI processes, user gets result! âš¡
